{% extends 'base.html' %}
{% load static %}

{% block title %}–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏{% endblock %}
{% block body_class %}booking-page{% endblock %}

{% block content %}
<div class="booking-container">
    <div class="booking-wizard">
        <div class="wizard-steps">
            <div class="step active" data-step="1">1. –í—ã–±–æ—Ä —É—Å–ª—É–≥–∏</div>
            <div class="step" data-step="2">2. –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è</div>
            <div class="step" data-step="3">3. –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div>
            <div class="step" data-step="4">4. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</div>
        </div>

        <div class="booking-form-container">
            <h1 class="booking-title">–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏</h1>
            <p class="booking-subtitle">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –Ω–∏–∂–µ –¥–ª—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å—ä–µ–º–∫–∏</p>

            <form method="post" class="booking-form" id="bookingForm">
                {% csrf_token %}

                {% if form.errors %}
                <div class="error-message">
                    <div class="error-icon">‚ö†Ô∏è</div>
                    <div class="error-content">
                        <h4>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø—Ä–∞–≤—å—Ç–µ –æ—à–∏–±–∫–∏:</h4>
                        <ul>
                            {% for field in form %}
                                {% for error in field.errors %}
                                    <li>{{ field.label }}: {{ error }}</li>
                                {% endfor %}
                            {% endfor %}
                            {% for error in form.non_field_errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
                {% endif %}

                <!-- –®–∞–≥ 1: –í—ã–±–æ—Ä —É—Å–ª—É–≥–∏ -->
                <div class="form-step active" id="step1" data-step="1">
                    <h3>–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É</h3>
                    <div class="services-grid">
                        {% for service in form.service.field.queryset %}
                        <div class="service-option" data-service-id="{{ service.id }}">
                            <div class="service-icon">
                                {% if service.service_type == 'PHOTO' %}üì∑
                                {% elif service.service_type == 'VIDEO' %}üé•
                                {% elif service.service_type == 'EDITING' %}üíª
                                {% else %}‚ú®{% endif %}
                            </div>
                            <h4>{{ service.name }}</h4>
                            <p class="service-price">{{ service.price }} —Ä—É–±.</p>
                            <p class="service-duration">{{ service.duration }}</p>
                            <button type="button" class="select-service-btn" data-service="{{ service.id }}">
                                –í—ã–±—Ä–∞—Ç—å
                            </button>
                        </div>
                        {% empty %}
                        <p class="no-services">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å–ª—É–≥ –¥–ª—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.</p>
                        {% endfor %}
                    </div>
                    <input type="hidden" name="service" id="id_service" value="{{ form.service.value|default:'' }}">
                </div>

                <!-- –®–∞–≥ 2: –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è -->
                <div class="form-step" id="step2" data-step="2">
                    <h3>–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è</h3>

                    <div class="date-selection">
                        <h4>–î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–∞—Ç—ã</h4>
                        <div class="available-dates">
                            {% for date in available_dates %}
                            <div class="date-option {% if date == form.booking_date.value %}selected{% endif %}"
                                 data-date="{{ date|date:'Y-m-d' }}">
                                <span class="day">{{ date|date:'d' }}</span>
                                <span class="month">{{ date|date:'M' }}</span>
                                <span class="weekday">{{ date|date:'D' }}</span>
                            </div>
                            {% endfor %}
                        </div>

                        <div class="time-selection">
                            <div class="form-group">
                                <label for="{{ form.booking_date.id_for_label }}" class="form-label">–î–∞—Ç–∞ —Å—ä–µ–º–∫–∏</label>
                                <input type="text" name="booking_date" id="id_booking_date" class="form-input"
                                       value="{{ form.booking_date.value|default:'' }}" readonly>
                            </div>

                            <div class="form-group">
                                <label for="{{ form.booking_time.id_for_label }}" class="form-label">–í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞</label>
                                {{ form.booking_time }}
                                <small class="form-help">–†–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è —Å 9:00 –¥–æ 21:00</small>
                            </div>

                            <div class="form-group">
                                <label for="{{ form.duration.id_for_label }}" class="form-label">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (—á–∞—Å—ã)</label>
                                {{ form.duration }}
                                <small class="form-help">–ú–∏–Ω–∏–º—É–º 1 —á–∞—Å, –º–∞–∫—Å–∏–º—É–º 8 —á–∞—Å–æ–≤</small>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="{{ form.location.id_for_label }}" class="form-label">–ú–µ—Å—Ç–æ —Å—ä–µ–º–∫–∏</label>
                        {{ form.location }}
                        <small class="form-help">–ê–¥—Ä–µ—Å –∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Å—Ç–∞</small>
                    </div>
                </div>

                <!-- –®–∞–≥ 3: –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
                <div class="form-step" id="step3" data-step="3">
                    <h3>–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>

                    <div class="form-group">
                        <label for="{{ form.client_name.id_for_label }}" class="form-label">–í–∞—à–µ –∏–º—è</label>
                        {{ form.client_name }}
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="{{ form.client_phone.id_for_label }}" class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                            {{ form.client_phone }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.client_email.id_for_label }}" class="form-label">Email</label>
                            {{ form.client_email }}
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="{{ form.client_message.id_for_label }}" class="form-label">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è</label>
                        {{ form.client_message }}
                        <small class="form-help">–û–ø–∏—à–∏—Ç–µ –≤–∞—à–∏ –∏–¥–µ–∏, —Å—Ç–∏–ª—å —Å—ä–µ–º–∫–∏, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª—é–¥–µ–π –∏ —Ç.–¥.</small>
                    </div>
                </div>

                <!-- –®–∞–≥ 4: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ -->
                <div class="form-step" id="step4" data-step="4">
                    <h3>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</h3>

                    <div class="booking-summary">
                        <div class="summary-card">
                            <h4>–î–µ—Ç–∞–ª–∏ —É—Å–ª—É–≥–∏</h4>
                            <div class="summary-item">
                                <span class="label">–£—Å–ª—É–≥–∞:</span>
                                <span class="value" id="summary-service">‚Äî</span>
                            </div>
                            <div class="summary-item">
                                <span class="label">–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è:</span>
                                <span class="value" id="summary-datetime">‚Äî</span>
                            </div>
                            <div class="summary-item">
                                <span class="label">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</span>
                                <span class="value" id="summary-duration">‚Äî</span>
                            </div>
                            <div class="summary-item">
                                <span class="label">–ú–µ—Å—Ç–æ:</span>
                                <span class="value" id="summary-location">‚Äî</span>
                            </div>
                        </div>

                        <div class="summary-card">
                            <h4>–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
                            <div class="summary-item">
                                <span class="label">–ò–º—è:</span>
                                <span class="value" id="summary-name">‚Äî</span>
                            </div>
                            <div class="summary-item">
                                <span class="label">–¢–µ–ª–µ—Ñ–æ–Ω:</span>
                                <span class="value" id="summary-phone">‚Äî</span>
                            </div>
                            <div class="summary-item">
                                <span class="label">Email:</span>
                                <span class="value" id="summary-email">‚Äî</span>
                            </div>
                        </div>

                        <div class="summary-card price-card">
                            <h4>–°—Ç–æ–∏–º–æ—Å—Ç—å</h4>
                            <div class="summary-item total-price">
                                <span class="label">–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:</span>
                                <span class="value" id="summary-price">‚Äî —Ä—É–±.</span>
                            </div>
                            <small class="price-note">–û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ –ø–æ—Å–ª–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π</small>
                        </div>
                    </div>

                    <div class="form-group terms-checkbox">
                        <label class="checkbox-label">
                            {{ form.confirm_terms }}
                            <span class="checkbox-custom"></span>
                            –Ø —Å–æ–≥–ª–∞—Å–µ–Ω —Å <a href="#" class="terms-link">—É—Å–ª–æ–≤–∏—è–º–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</a> –∏
                            <a href="#" class="terms-link">–ø–æ–ª–∏—Ç–∏–∫–æ–π –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>
                        </label>
                    </div>
                </div>

                <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —à–∞–≥–∞–º -->
                <div class="form-navigation">
                    <button type="button" class="nav-button prev-btn" disabled>‚Üê –ù–∞–∑–∞–¥</button>
                    <button type="button" class="nav-button next-btn">–î–∞–ª–µ–µ ‚Üí</button>
                    <button type="submit" class="submit-btn" style="display: none;">–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
    /* –í—Å–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è —Ç–∞–∫–∏–º–∏ –∂–µ, –∫–∞–∫ –≤—ã –∏—Ö –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª–∏ */
    /* –Ø –Ω–µ –±—É–¥—É –∏—Ö –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å –æ—Ç–≤–µ—Ç */
    .booking-page {
        padding-top: 100px;
        min-height: 100vh;
        background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
    }

    .booking-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem;
    }

    /* ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ ... */

    .form-input {
        width: 100%;
        padding: 1rem;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid #333;
        border-radius: 10px;
        color: white;
        font-size: 1rem;
        transition: border-color 0.3s ease;
    }

    /* ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ ... */
</style>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    console.log('DOM –∑–∞–≥—Ä—É–∂–µ–Ω, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä–º—ã –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è...');

    // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
    const steps = document.querySelectorAll('.form-step');
    const stepIndicators = document.querySelectorAll('.step');
    const prevBtn = document.querySelector('.prev-btn');
    const nextBtn = document.querySelector('.next-btn');
    const submitBtn = document.querySelector('.submit-btn');
    const form = document.getElementById('bookingForm');

    let currentStep = 0;

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    if (!steps.length || !stepIndicators.length || !prevBtn || !nextBtn || !submitBtn || !form) {
        console.error('–ù–µ –Ω–∞–π–¥–µ–Ω—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã DOM');
        return;
    }

    console.log('–≠–ª–µ–º–µ–Ω—Ç—ã –Ω–∞–π–¥–µ–Ω—ã, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...');

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    showStep(currentStep);
    updateServiceOptions();
    initEventListeners();

    function initEventListeners() {
        // –í—ã–±–æ—Ä —É—Å–ª—É–≥–∏
        const serviceBtns = document.querySelectorAll('.select-service-btn');
        serviceBtns.forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.preventDefault();
                const serviceId = this.dataset.service;
                console.log('–í—ã–±—Ä–∞–Ω–∞ —É—Å–ª—É–≥–∞:', serviceId);

                document.getElementById('id_service').value = serviceId;

                // –û–±–Ω–æ–≤–ª—è–µ–º UI
                document.querySelectorAll('.service-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                this.closest('.service-option').classList.add('selected');

                // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É
                nextStep();
            });
        });

        // –í—ã–±–æ—Ä –¥–∞—Ç—ã
        const dateOptions = document.querySelectorAll('.date-option');
        dateOptions.forEach(option => {
            option.addEventListener('click', function(e) {
                e.preventDefault();
                const date = this.dataset.date;
                console.log('–í—ã–±—Ä–∞–Ω–∞ –¥–∞—Ç–∞:', date);

                document.getElementById('id_booking_date').value = date;

                // –û–±–Ω–æ–≤–ª—è–µ–º UI
                document.querySelectorAll('.date-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                this.classList.add('selected');
            });
        });

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–≤–æ–¥–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
        const inputs = document.querySelectorAll('#step2 input, #step3 input, #step3 textarea, #id_booking_time, #id_duration, #id_location');
        inputs.forEach(input => {
            input.addEventListener('change', updateSummary);
            input.addEventListener('input', updateSummary);
        });

        // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —à–∞–≥–∞–º
        prevBtn.addEventListener('click', prevStep);
        nextBtn.addEventListener('click', nextStep);

        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã
        form.addEventListener('submit', function(e) {
            if (!validateStep(currentStep)) {
                e.preventDefault();
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è');
            }
        });
    }

    // –§—É–Ω–∫—Ü–∏–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    function showStep(step) {
        // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —à–∞–≥–∏
        steps.forEach(s => s.classList.remove('active'));
        stepIndicators.forEach(s => s.classList.remove('active'));

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π —à–∞–≥
        if (steps[step]) steps[step].classList.add('active');
        if (stepIndicators[step]) stepIndicators[step].classList.add('active');

        // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏
        prevBtn.disabled = step === 0;

        if (step === steps.length - 1) {
            nextBtn.style.display = 'none';
            submitBtn.style.display = 'block';
            updateSummary();
        } else {
            nextBtn.style.display = 'block';
            submitBtn.style.display = 'none';
        }

        currentStep = step;
        console.log('–¢–µ–∫—É—â–∏–π —à–∞–≥:', step + 1);
    }

    function nextStep() {
        console.log('–ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É...');
        // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–∫—É—â–µ–≥–æ —à–∞–≥–∞
        if (validateStep(currentStep)) {
            if (currentStep < steps.length - 1) {
                showStep(currentStep + 1);
            }
        }
    }

    function prevStep() {
        console.log('–ü–µ—Ä–µ—Ö–æ–¥ –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É —à–∞–≥—É...');
        if (currentStep > 0) {
            showStep(currentStep - 1);
        }
    }

    function validateStep(step) {
        let isValid = true;

        // –í–∞–ª–∏–¥–∞—Ü–∏—è —à–∞–≥–∞ 1 (–≤—ã–±–æ—Ä —É—Å–ª—É–≥–∏)
        if (step === 0) {
            const serviceId = document.getElementById('id_service').value;
            if (!serviceId) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É');
                isValid = false;
            }
        }

        // –í–∞–ª–∏–¥–∞—Ü–∏—è —à–∞–≥–∞ 2 (–¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è)
        if (step === 1) {
            const date = document.getElementById('id_booking_date').value;
            const time = document.getElementById('id_booking_time').value;
            const duration = document.getElementById('id_duration').value;

            if (!date || !time || !duration) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏');
                isValid = false;
            }
        }

        // –í–∞–ª–∏–¥–∞—Ü–∏—è —à–∞–≥–∞ 3 (–∫–æ–Ω—Ç–∞–∫—Ç—ã)
        if (step === 2) {
            const name = document.getElementById('id_client_name').value;
            const phone = document.getElementById('id_client_phone').value;
            const email = document.getElementById('id_client_email').value;

            if (!name || !phone || !email) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –ø–æ–ª—è');
                isValid = false;
            }
        }

        // –í–∞–ª–∏–¥–∞—Ü–∏—è —à–∞–≥–∞ 4 (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ)
        if (step === 3) {
            const terms = document.getElementById('id_confirm_terms');
            if (terms && !terms.checked) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–æ–≥–ª–∞—Å–∏—Ç–µ—Å—å —Å —É—Å–ª–æ–≤–∏—è–º–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è');
                isValid = false;
            }
        }

        return isValid;
    }

    function updateServiceOptions() {
        const serviceId = document.getElementById('id_service').value;
        if (serviceId) {
            document.querySelectorAll('.service-option').forEach(opt => {
                if (opt.dataset.serviceId === serviceId) {
                    opt.classList.add('selected');
                }
            });
        }
    }

    function updateSummary() {
        console.log('–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–≤–æ–¥–∫–∏...');

        // –£—Å–ª—É–≥–∞
        const serviceId = document.getElementById('id_service').value;
        const serviceOption = document.querySelector(`.service-option[data-service-id="${serviceId}"]`);
        if (serviceOption) {
            const serviceName = serviceOption.querySelector('h4');
            if (serviceName) {
                document.getElementById('summary-service').textContent = serviceName.textContent;
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–æ–∏–º–æ—Å—Ç—å
            const priceElement = serviceOption.querySelector('.service-price');
            if (priceElement) {
                const price = priceElement.textContent.replace(' —Ä—É–±.', '');
                const duration = document.getElementById('id_duration').value || 1;
                const totalPrice = parseInt(price) * parseInt(duration);
                document.getElementById('summary-price').textContent = `${totalPrice} —Ä—É–±.`;
            }
        }

        // –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è
        const date = document.getElementById('id_booking_date').value;
        const time = document.getElementById('id_booking_time').value;
        const duration = document.getElementById('id_duration').value;

        if (date && time) {
            const [year, month, day] = date.split('-');
            const [hours, minutes] = time.split(':');
            const dateObj = new Date(year, month - 1, day, hours, minutes);

            const options = {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };

            document.getElementById('summary-datetime').textContent =
                dateObj.toLocaleDateString('ru-RU', options);
        }

        if (duration) {
            document.getElementById('summary-duration').textContent = duration + ' —á–∞—Å–æ–≤';
        }

        // –ú–µ—Å—Ç–æ
        const location = document.getElementById('id_location').value;
        document.getElementById('summary-location').textContent = location || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';

        // –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        const nameInput = document.getElementById('id_client_name');
        const phoneInput = document.getElementById('id_client_phone');
        const emailInput = document.getElementById('id_client_email');

        if (nameInput) document.getElementById('summary-name').textContent = nameInput.value || '‚Äî';
        if (phoneInput) document.getElementById('summary-phone').textContent = phoneInput.value || '‚Äî';
        if (emailInput) document.getElementById('summary-email').textContent = emailInput.value || '‚Äî';
    }
});
</script>
{% endblock %}